# STM32_RemoteControlCar
STM32 part of a remote control car

本科三年级小学期课程 硬件综合训练 使用STM32F103VCT6 底层对小车控制部分硬件代码

1.小车驱动


使用4个步进电机驱动小车，步进电机连接驱动板，驱动板解决驱动问题。STM32负责提供四个轮子的PWM波，使能信号，轮子转动方向信号
TIM3产生单个使能信供给全轮使用，转弯使用半侧车轮反转

2.舵机驱动

总线舵机使用串口驱动，USART2控制舵机，下面控制摄像头左右转的是1号舵机，控制俯仰的是2号，直接按照手册上的指令格式发送指令即可，范围0x0-0x03ff，对应0-300度

3.超声波避障

超声波需要trigger10us的脉冲信号启动，需要接5v电压，收到脉冲后发出8个40kh声波，声波接触到物体反射后被接收，从接收一刻开始，echo口模拟出一个与声波在空气中传播时间一样的高电平。所以 高电平时间/2 == 声波接触到物体的时间。程序中600us大概是声波在空气中传播20cm的时间。

使用TIM2当作计时器，使用外部中断，检测到高电平以后进入中断服务程序，程序中先启动计时器，然后不断检测是否变为低电平，如果到低电平则读出CNT并关闭计时器。然后计算距离，如果小于既定时间则停止。

4.串口通信

使用USART1作为与上层（此处为树莓派）通信的串口。一次接收一个byte，以美元$为结束符。接收与发送都要写循环，读取接收与发送标志位，看是否完成了接收与发送，否则可能将把缓冲区内信息冲掉。

5.蜂鸣器

在上升沿和下降沿都会发声一次。在while中循环强撸高低电平变化即可发声。在中断程序中改变标志位来停止发声。



几点注意：

1.电池非常容易过放，微微发热时就已经产生过放。

2.使用串口通信时不仅要注意RS232要将发送与接收扭一下，通信两端必须共地。

3.Github在线编辑README会出现双击现象，以后在本地编辑好再上传。
